/~ ~~~~~~~ Token Defns ~~~~~~~~ ~/

/~ whitespace ~/
!	' |\t'
;

/~ keywords ~/
'attribute'	ATTRIBUTE
'const'		CONST
'bool'		BOOL
'float' 	FLOAT
'int'		INT
'break'		BREAK
'continue'	CONTINUE
'do'		DO
'else'		ELSE
'for'		FOR
'if'		IF
'discard'	DISCARD
'return'	RETURN
'bvec2'		BVEC2
'bvec3'		BVEC3
'bvec4'		BVEC4
'ivec2'		IVEC2
'ivec3'		IVEC3
'ivec4'		IVEC4
'vec2'		VEC2
'vec3'		VEC3
'vec4'		VEC4
'mat2'		MAT2
'mat3'		MAT3
'mat4'		MAT4
'in'		IN
'out'		OUT
'inout'		INOUT
'uniform'	UNIFORM
'varying'	VARYING
'sampler2d'	SAMPLER2D
'samplercube'	SAMPLERCUBE
'struct'	STRUCT
'void'		VOID
'while'		WHILE
;


/~ identifiers of the form 
 ~ identifier :
 ~   nondigit
 ~   identifier nondigit 
 ~   identifier digit
 ~/
'[a-zA-Z\_]+[0-9]*'									IDENTIFIER
'void|bool|int|float|(bi)?vec[2-4]|mat[2-4]|sampler2D|samplerCube'			TYPE_NAME
/~ float constants (conveniently the same format as accepted by parseFloat)
 ~ floating-constant : fractional-constant [exponent-part] | digit-sequence exponent-part 
 ~ fractional-constant : digit-sequence . digit-sequence | digit-sequence . | . digit-sequence
 ~ exponent-part : e [sign] digit-sequence | E [sign] digit-sequence
 ~/
'([0-9]+\.[0-9]+|[0-9]+\.|\.[0-9]+)((e|E)(\+|\-)?[0-9]+)?|[0-9]+(e|E)(\+|\-)?[0-9]+'	FLOATCONSTANT	[* %match = parseFloat(%match); *]
/~ integer constants (same as parseInt)
 ~ integer-constant : decimal-constant | octal-constant | hexadecimal-constant
 ~ decimal-constant :  nonzero-digit | decimal-constant digit
 ~ octal-constant : 0 | octal-constant octal-digit
 ~ hexadecimal-constant : 0x hexadecimal-digit | 0X hexadecimal-digit | hexadecimal-constant hexadecimal-digit
 ~/
'[1-9][0-9]+|0[0-7]+|0(x|X)[0-9a-fA-F]+'						INTCONSTANT	[* %match = parseInt(%match); *]
'true|false'	     	BOOLCONSTANT	[* %match = %match == 'true' *]
/~FIELD_SELECTION
LEFT_OP
RIGHT_OP
'++' INC_OP
'--' DEC_OP
'<=' LE_OP
'>=' GE_OP
'==' EQ_OP
'!=' NE_OP
AND_OP
OR_OP
XOR_OP
'*=' MUL_ASSIGN
'/=' DIV_ASSIGN
'+=' ADD_ASSIGN
'%=' MOD_ASSIGN
LEFT_ASSIGN
RIGHT_ASSIGN
AND_ASSIGN
XOR_ASSIGN
OR_ASSIGN
SUB_ASSIG~/
;
##

/~ ~~~~~~~~~ Grammar ~~~~~~~~~ ~/

e: FLOATCONSTANT [* alert(%1) *]
;
